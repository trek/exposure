<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
     <meta http-equiv="content-type" content="text/html; charset=utf-8" />
     <title>Exposure responding</title>
     <meta name="author" content="Trek glowakcki" />
     <!-- syntax highlighting CSS -->
     <link rel="stylesheet" href="css/syntax.css" type="text/css" />
     <!-- Homepage CSS -->
     <link rel="stylesheet" href="css/style.css" type="text/css" media="screen, projection" />
  </head>
  <body>
    
    <div class="container">
      
      <h1>Responding</h1>

<table>
<thead>
<tr>
<th>Action    </th>
<th> Success Response               </th>
<th> Failed Response</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>index</code>   </td>
<td> rendered <code>index</code>               </td>
<td> 404</td>
</tr>
<tr>
<td><code>show</code>    </td>
<td> rendered <code>show</code>                </td>
<td> 404</td>
</tr>
<tr>
<td><code>new</code>     </td>
<td> rendered <code>new</code>                 </td>
<td> 404</td>
</tr>
<tr>
<td><code>create</code>  </td>
<td> redirect <code>show</code> of new object  </td>
<td> rendered <code>new</code></td>
</tr>
<tr>
<td><code>edit</code>    </td>
<td> rendered <code>edit</code>                </td>
<td> 404</td>
</tr>
<tr>
<td><code>update</code>  </td>
<td> redirect <code>show</code> of object      </td>
<td> rendered <code>edit</code></td>
</tr>
<tr>
<td><code>destroy</code> </td>
<td> rendered <code>index</code>               </td>
<td> </td>
</tr>
</tbody>
</table>


<h2>Customized Responding</h2>

<p>Default responses can be customized with the ActionController class method <code>response_for</code>. You can replace a response with a method name (as symbol), Proc object, or a block. You can respond differently to successful and unsuccessful execution by passing the <code>:on</code> option with a value of either <code>:success</code> or <code>:failure</code>.</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">PostsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">expose</span> <span class="ss">:posts</span>
  <span class="n">response_for</span> <span class="ss">:update</span><span class="p">,</span> <span class="ss">:on</span> <span class="o">=&gt;</span> <span class="ss">:success</span><span class="p">,</span> <span class="ss">:is</span> <span class="o">=&gt;</span> <span class="ss">:redirect_after_update</span>
  <span class="kp">private</span>
    <span class="k">def</span> <span class="nf">redirect_after_update</span>
      <span class="n">redirect_to</span> <span class="n">post_url</span><span class="p">(</span><span class="vi">@post</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre>
</div>




<div class="highlight"><pre><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">expose</span> <span class="ss">:products</span>
  <span class="n">response_for</span> <span class="ss">:index</span><span class="p">,</span> <span class="ss">:is</span> <span class="o">=&gt;</span> <span class="no">Proc</span><span class="o">.</span><span class="n">new</span> <span class="p">{</span> <span class="n">render</span><span class="p">(</span><span class="s1">&#39;scoped_index&#39;</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</pre>
</div>




<div class="highlight"><pre><span class="k">class</span> <span class="nc">PuppiesController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">expose</span> <span class="ss">:puppies</span>
  <span class="n">response_for</span> <span class="ss">:new</span><span class="p">,</span> <span class="ss">:on</span> <span class="o">=&gt;</span> <span class="ss">:success</span> <span class="k">do</span>
    <span class="n">render</span><span class="p">(</span><span class="s1">&#39;new_adoption_form&#39;</span><span class="p">)</span>
  <span class="k">end</span>
  
  <span class="n">response_for</span> <span class="ss">:new</span><span class="p">,</span> <span class="ss">:on</span> <span class="o">=&gt;</span> <span class="ss">:failure</span> <span class="k">do</span>
    <span class="k">raise</span> <span class="no">AdoptionNotAllowed</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
</div>


<h2>Format-specific Responding</h2>

<p>You can create responses for specific formats by passing <code>:format</code> option with an array of formats as symbols. The default option is <code>:html</code> only.</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="c1"># remember to add pdf as an acceptable mime-type in your configuration</span>
  <span class="c1"># Mime::Type.register &quot;application/pdf&quot;, :pdf</span>
  <span class="n">expose</span> <span class="ss">:products</span>
  <span class="n">response_for</span> <span class="ss">:show</span><span class="p">,</span> <span class="ss">:formats</span> <span class="o">=&gt;</span> <span class="ss">:pdf</span> <span class="k">do</span>
    <span class="n">send_data</span><span class="p">(</span><span class="no">MyCoolPDFWriter</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="vi">@product</span><span class="p">),</span>
            <span class="ss">:filename</span> <span class="o">=&gt;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="vi">@product</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.pdf&quot;</span><span class="p">,</span>
            <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s2">&quot;application/pdf&quot;</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
</div>


      
      
        <span class='previous'>
          &#x261c; <a href='building.html'>Building</a>
        </span>
      
      
      
        <span class='next'>
          <a href='flashing.html'>Flashing</a> &#x261E;
        </span>
      
      <div class="footer"></div>
    </div>
    
    <a href="http://github.com/trek/exposure">
      <img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
    </a>
  </body>
</html>
